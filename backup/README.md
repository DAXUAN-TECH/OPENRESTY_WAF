# 备份目录说明

## 目录用途

`backup/` 目录用于存放本项目运行过程中产生的各类备份文件，便于统一管理与恢复，包括但不限于：

- 配置文件备份（如：`conf.d/`、`lua/` 等关键配置）
- 数据库备份（如：`waf_db_backup_YYYYMMDD_HHMMSS.sql`）
- 规则与策略备份（如：WAF 规则、白名单、代理配置等导出文件）
- 其他运维脚本或定时任务生成的备份文件

> 建议在定时任务（crontab）或运维脚本中，将所有与本项目相关的备份文件统一输出到本目录下，便于集中管理与清理。

## 推荐子目录结构

为了便于分类管理，建议在 `backup/` 目录下按类型或日期创建子目录，例如：

- `backup/nginx_conf/`：Nginx / OpenResty 配置备份
- `backup/db/`：数据库备份文件
- `backup/rules/`：WAF 规则与白名单备份
- `backup/logs/`：重要日志备份

也可以按日期归档，如：

- `backup/2025-11-29/nginx_conf/`
- `backup/2025-11-29/db/`

## 清理策略建议

在生产环境中，备份文件会随着时间增长而占用大量磁盘空间，建议：

- 使用定时任务（crontab）或脚本定期清理超过一定天数的历史备份
- 对关键备份（如里程碑变更、重大版本升级前后）进行额外归档或异地备份
- 清理策略需与公司备份与合规策略保持一致

## 安全与权限建议

- 建议将 `backup/` 目录权限限制为仅运维账号和所需服务账号可访问
- 备份文件中可能包含敏感信息（如数据库账号、内部域名、IP 等），请勿直接对外共享
- 如需对备份进行加密，请在备份脚本中集成加密流程（例如使用 `gpg` 或对称加密）

## 相关文档

- `scripts/migrate_database_tables_README.md`：数据库结构迁移与备份说明
- `docs/部署文档.md`：部署与运维相关说明
- `docs/硬件开销与并发量分析.md`：容量规划与性能分析


