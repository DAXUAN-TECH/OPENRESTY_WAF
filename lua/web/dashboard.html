<script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>

<link rel="stylesheet" href="/css/dashboard.css">

<div class="container">
    <div class="auto-refresh">
        <label>
            <input type="checkbox" id="autoRefresh" checked> 自动刷新（30秒）
        </label>
    </div>

    <div id="loading" class="loading">加载中...</div>

    <div id="content" style="display:none;">
        <div class="metrics-grid">
        <div class="metric-card">
            <h3>数据库健康状态</h3>
            <div class="value" id="dbHealth">-</div>
            <span class="status" id="dbStatus">检查中</span>
        </div>
        <div class="metric-card">
            <h3>总封控次数</h3>
            <div class="value" id="totalBlocks">0</div>
            <div class="metric-trend" id="blocksTrend"></div>
        </div>
        <div class="metric-card">
            <h3>缓存命中率</h3>
            <div class="value" id="cacheHitRate">0%</div>
            <div class="metric-trend" id="cacheTrend"></div>
        </div>
        <div class="metric-card">
            <h3>当前被封控IP数</h3>
            <div class="value" id="blockedIPs">0</div>
            <div class="metric-trend" id="ipsTrend"></div>
        </div>
        <div class="metric-card">
            <h3>规则匹配耗时</h3>
            <div class="value" id="matchDuration">0ms</div>
            <div class="metric-trend" id="durationTrend"></div>
        </div>
        <div class="metric-card">
            <h3>降级模式</h3>
            <div class="value" id="fallbackMode">-</div>
            <span class="status" id="fallbackStatus">检查中</span>
        </div>
        <div class="metric-card">
            <h3>自动封控次数</h3>
            <div class="value" id="autoBlocks">0</div>
            <div class="metric-trend" id="autoBlocksTrend"></div>
        </div>
        <div class="metric-card">
            <h3>缓存命中次数</h3>
            <div class="value" id="cacheHits">0</div>
            <div class="metric-trend" id="cacheHitsTrend"></div>
        </div>
    </div>
    
    <div class="chart-container">
        <h2>封控趋势（最近1小时）</h2>
        <canvas id="blockTrendChart"></canvas>
    </div>
    
    <div class="info-section">
        <h2>系统信息</h2>
        <div class="info-item">
            <span class="info-label">当前时间</span>
            <span class="info-value" id="currentTime">-</span>
        </div>
        <div class="info-item">
            <span class="info-label">数据库连接状态</span>
            <span class="info-value" id="dbConnection">-</span>
        </div>
        <div class="info-item">
            <span class="info-label">缓存状态</span>
            <span class="info-value" id="cacheStatus">-</span>
        </div>
        <div class="info-item">
            <span class="info-label">自动封控状态</span>
            <span class="info-value" id="autoBlockStatus">-</span>
        </div>
        <div class="info-item">
            <span class="info-label">系统运行时间</span>
            <span class="info-value" id="uptime">-</span>
        </div>
    </div>
</div>
</div>



