<script src="/js/logs.js"></script>
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>日志查看 - WAF管理</title>
    <link rel="stylesheet" href="/css/logs.css">
</head>
<body>
    <div class="container">
        <h1>日志查看</h1>
        <div class="tabs">
            <button class="tab active" data-tab="access">访问日志</button>
            <button class="tab" data-tab="block">封控日志</button>
            <button class="tab" data-tab="audit">审计日志</button>
        </div>
        
        <!-- 访问日志 -->
        <div class="tab-content active" id="access-tab">
            <div class="filters">
                <div class="filters-row">
                    <div class="filter-group">
                        <label>客户端IP</label>
                        <input type="text" id="access-client-ip" placeholder="192.168.1.1">
                    </div>
                    <div class="filter-group">
                        <label>请求域名</label>
                        <input type="text" id="access-domain" placeholder="example.com">
                    </div>
                    <div class="filter-group">
                        <label>请求路径</label>
                        <input type="text" id="access-path" placeholder="/api/">
                    </div>
                    <div class="filter-group">
                        <label>状态码</label>
                        <input type="text" id="access-status" placeholder="200">
                    </div>
                </div>
                <div class="filters-row">
                    <div class="filter-group">
                        <label>开始时间</label>
                        <input type="datetime-local" id="access-start-time">
                    </div>
                    <div class="filter-group">
                        <label>结束时间</label>
                        <input type="datetime-local" id="access-end-time">
                    </div>
                </div>
                <div class="filter-actions">
                    <button class="btn btn-primary" onclick="loadAccessLogs()">查询</button>
                    <button class="btn btn-secondary" onclick="resetAccessFilters()">重置</button>
                </div>
            </div>
            
            <div id="access-loading" class="loading" style="display: none;">加载中...</div>
            <div id="access-error" class="error" style="display: none;"></div>
            <div class="table-container">
                <div class="table-wrapper">
                    <table id="access-table">
                        <thead>
                            <tr>
                                <th>时间</th>
                                <th>IP地址</th>
                                <th>域名</th>
                                <th>请求路径</th>
                                <th>方法</th>
                                <th>状态码</th>
                                <th>响应时间</th>
                                <th>User-Agent</th>
                            </tr>
                        </thead>
                        <tbody id="access-tbody"></tbody>
                    </table>
                </div>
                <div class="pagination" id="access-pagination"></div>
            </div>
        </div>
        
        <!-- 封控日志 -->
        <div class="tab-content" id="block-tab">
            <div class="filters">
                <div class="filters-row">
                    <div class="filter-group">
                        <label>客户端IP</label>
                        <input type="text" id="block-client-ip" placeholder="192.168.1.1">
                    </div>
                    <div class="filter-group">
                        <label>封控原因</label>
                        <select id="block-reason">
                            <option value="">全部</option>
                            <option value="manual">手动封控</option>
                            <option value="auto_frequency">自动频率封控</option>
                            <option value="auto_error">自动错误率封控</option>
                            <option value="auto_scan">自动扫描封控</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>规则名称</label>
                        <input type="text" id="block-rule-name" placeholder="规则名称">
                    </div>
                </div>
                <div class="filters-row">
                    <div class="filter-group">
                        <label>开始时间</label>
                        <input type="datetime-local" id="block-start-time">
                    </div>
                    <div class="filter-group">
                        <label>结束时间</label>
                        <input type="datetime-local" id="block-end-time">
                    </div>
                </div>
                <div class="filter-actions">
                    <button class="btn btn-primary" onclick="loadBlockLogs()">查询</button>
                    <button class="btn btn-secondary" onclick="resetBlockFilters()">重置</button>
                </div>
            </div>
            
            <div id="block-loading" class="loading" style="display: none;">加载中...</div>
            <div id="block-error" class="error" style="display: none;"></div>
            <div class="table-container">
                <div class="table-wrapper">
                    <table id="block-table">
                        <thead>
                            <tr>
                                <th>封控时间</th>
                                <th>IP地址</th>
                                <th>规则名称</th>
                                <th>封控原因</th>
                                <th>请求路径</th>
                                <th>User-Agent</th>
                            </tr>
                        </thead>
                        <tbody id="block-tbody"></tbody>
                    </table>
                </div>
                <div class="pagination" id="block-pagination"></div>
            </div>
        </div>
        
        <!-- 审计日志 -->
        <div class="tab-content" id="audit-tab">
            <div class="filters">
                <div class="filters-row">
                    <div class="filter-group">
                        <label>用户名</label>
                        <input type="text" id="audit-username" placeholder="admin">
                    </div>
                    <div class="filter-group">
                        <label>操作类型</label>
                        <select id="audit-action-type">
                            <option value="">全部</option>
                            <option value="login">登录</option>
                            <option value="logout">登出</option>
                            <option value="create">创建</option>
                            <option value="update">更新</option>
                            <option value="delete">删除</option>
                            <option value="enable">启用</option>
                            <option value="disable">禁用</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>资源类型</label>
                        <input type="text" id="audit-resource-type" placeholder="rule">
                    </div>
                    <div class="filter-group">
                        <label>状态</label>
                        <select id="audit-status">
                            <option value="">全部</option>
                            <option value="success">成功</option>
                            <option value="failed">失败</option>
                            <option value="error">错误</option>
                        </select>
                    </div>
                </div>
                <div class="filters-row">
                    <div class="filter-group">
                        <label>开始时间</label>
                        <input type="datetime-local" id="audit-start-time">
                    </div>
                    <div class="filter-group">
                        <label>结束时间</label>
                        <input type="datetime-local" id="audit-end-time">
                    </div>
                </div>
                <div class="filter-actions">
                    <button class="btn btn-primary" onclick="loadAuditLogs()">查询</button>
                    <button class="btn btn-secondary" onclick="resetAuditFilters()">重置</button>
                </div>
            </div>
            
            <div id="audit-loading" class="loading" style="display: none;">加载中...</div>
            <div id="audit-error" class="error" style="display: none;"></div>
            <div class="table-container">
                <div class="table-wrapper">
                    <table id="audit-table">
                        <thead>
                            <tr>
                                <th>操作时间</th>
                                <th>用户名</th>
                                <th>操作类型</th>
                                <th>资源类型</th>
                                <th>操作描述</th>
                                <th>状态</th>
                                <th>IP地址</th>
                            </tr>
                        </thead>
                        <tbody id="audit-tbody"></tbody>
                    </table>
                </div>
                <div class="pagination" id="audit-pagination"></div>
            </div>
        </div>
    </div>
    
    
</body>
</html>

